{% extends 'base.html' %}

{% block header %}
{% if term.language_id is none %}New Term{% else %}Edit Term{% endif %}
{% endblock %}

{% block body %}
<div id="term_form_left">
  {% include('term/_form.html') %}
  <a href="/term/index">Back to list</a>
</div>


<div id="term_form_right">
  <div class="dictcontainer">
    <div id="dicttabs">
      <div id="dicttabslayout"></div>
      <div id="dicttabsstatic"></div>
    </div>
    <div id="dictframes"></div>
  </div>
</div>

{% if term.language_id is none %}

  <script>
    const dictTabsContainer = document.getElementById("dicttabs");
    const loadDictsBtn = document.getElementById("load-dicts-btn");
    const langSelect = document.getElementById("language_id");
    const termField = document.getElementById("text");
    let term = "";
    let langid = 0;

    loadDictsBtn.addEventListener("click", (e) => {
      e.preventDefault();

      LANG_ID = langSelect.value;
      // continue only if lang or term has been changed
      if (termField.value && termField.value != term || 
          LANG_ID != 0 && LANG_ID != langid) {

        TERM_DICTS = ALL_DICTS[LANG_ID].term;
        if (dictTabs.length === 0) createDictTabs(5);
        loadDictionaries();

        term = termField.value;
        langid = LANG_ID;
      }
      
    })
  </script>

{% else %}

  <script>
    LANG_ID = $('#language_id').val();
    TERM_DICTS = ALL_DICTS[LANG_ID].term;
    createDictTabs(5);
    loadDictionaries();
  </script>

{% endif %}

{% endblock %}
